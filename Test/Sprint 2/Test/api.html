<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="style.css" rel="stylesheet" />
    <title>API Test</title>
  </head>
  <body>
    <h1>
      <ul></ul>
    </h1>
    <script>
      const url = "https://restcountries.com/v3.1/all";
      function getDataAndCreateArray(link) {
        const worldArray = [];
        fetch(link)
          .then((res) => {
            return res.json();
          })
          .then((data) => {
            console.log(data);
            for (i = 0; i < data.length; i++) {
              const country = {
                flag: [],
                name: data[i].name.common,
                capital: [],
                languages: [],
                population: data[i].population,
                continents: [],
                maps: data[i].maps.openStreetMaps,
                currenciesShort: [],
                currenciesLong: [],
                currenciesSymbol: [],
              };
              country.flag.push(data[i].flags);
              if (data[i].capital != undefined) {
                for (j = 0; j < data[i].capital.length; j++) {
                  country.capital.push(data[i].capital[j]);
                }
              } else {
                country.capital.push("N.A.");
              }
              for (j = 0; j < data[i].continents.length; j++) {
                country.continents.push(data[i].continents[j]);
              }

              // if (data[i].languages != undefined) {
              //   for (value of Object.values(data[i].languages)) {
              //     console.log(`'langs' ${value}`);
              //   }
              // }
              // if (data[i].currencies != undefined) {
              //   for (j = 0; j < data[i].currencies.length; j++) {
              //     console.log(data[i].currencies[j]);
              //   }
              // }

              if (data[i].languages != undefined) {
                for (j = 0; j < Object.values(data[i].languages).length; j++) {
                  country.languages.push(Object.values(data[i].languages)[j]);
                }
              }
              if (data[i].languages != undefined) {
              }
              // if (
              //   data[i].currencies != undefined &&
              //   data[i].currencies.values != undefined
              // ) {
              //   for (j = 0; j < Object.values(data[i].currencies).length; j++) {
              //     country.currencies.push(
              //       Object.values(data[i].currencies)[j].values
              //     );
              //   }
              // }
              // Object.entries(([k, v]) => {
              //   console.log(k, v);
              // });
              // if (data[i].languages != undefined) {
              //   for (j = 0; j < Object.keys(data[i].languages).length; j++) {
              //     console.log(Object.keys(data[i].languages)[j]);
              //     country.languages.push(Object.keys(data[i].languages)[j]);
              //   }
              // }
              // if (data[i].currencies != undefined) {
              //   for (const [key, value] of Object.entries(data[i].currencies)) {
              //     for (
              //       j = 0;
              //       j < Object.entries(data[i].currencies).length;
              //       j++
              //     ) {
              //       console.log(`${[i]}       ${key}:`);
              //     }

              // country.currenciesShort.push(
              //   Object.entries(data[i].currencies).key
              // );
              //  data[i].currenciesShort.push(key);
              // }
              // }
              if (data[i].currencies != undefined) {
                country.currenciesShort.push(Object.keys(data[i].currencies));
                let obj = Object.entries(data[i].currencies);
                //    console.log(Object.entries(data[i].currencies));
                //  console.log(obj[0][1]["name"]);

                // for (j = 0; j < obj2.length; j++) {
                //   country.currenciesLong.push(obj[0][j]["name"]);
                // }

                // if (obj[0][2]["name"] != undefined) {
                //   country.currenciesLong.push(obj[0][2]["name"]);
                // }
                country.currenciesSymbol.push(obj[0][1]["symbol"]);
                //  console.log(Object.entries(obj));
              }

              // if (data[i].currencies != undefined) {
              //   for (j = 0; j < Object.values(data[i].currencies).length; j++) {
              //     country.currencies.push(Object.values(data[i].currencies.name)[j]);
              //     console.log(Object.values(data[i].currencies)[j]);
              //   }
              // } else {
              //   country.currencies.push("N.A.");
              // }

              // if (data[i].currencies != undefined) {
              //   for (j = 0; j < data[i].currencies.length; j++) {
              //     country.currencies.push(data[i].currencies[j].toString());
              //   }}

              console.log(
                [i] +
                  " | " +
                  +country.flag +
                  " | " +
                  country.name +
                  " | " +
                  country.capital +
                  " | " +
                  country.continents +
                  " | " +
                  country.languages +
                  " | " +
                  country.maps +
                  " | " +
                  country.currenciesShort +
                  " | " +
                  country.currenciesLong +
                  " | " +
                  country.currenciesSymbol
              );
              worldArray.push(country);
            }
          });
        return worldArray;
      }
      let worldArr = getDataAndCreateArray(url);

      // let fetchPromise = getDataAndCreateArray(url).then((results) => {
      //   console.log(results);
      //   return results;
      // });

      // const entry = `<li>${data[i].name.common}<br>-${data[i].capital}<br>-${data[i].population}</li>`;
      // document.querySelector("ul").insertAdjacentHTML("beforeend", entry);
    </script>
  </body>
</html>
